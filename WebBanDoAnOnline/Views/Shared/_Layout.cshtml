<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - FuTho Food</title>

    <!-- Link Bootstrap CSS (sử dụng CDN cho đơn giản) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Link tới Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />

    <!-- Dòng này sẽ render file Site.css của bạn từ BundleConfig -->
    @Styles.Render("~/Content/css")
</head>
<body>
    @* Determine current route to set active menu item *@
    @{
        var currentController = (ViewContext.RouteData.Values["controller"] as string) ?? "";
        var currentAction = (ViewContext.RouteData.Values["action"] as string) ?? "";
    }

    <main class="page-content">
        <header class="main-header">
            <!-- navbar và navbar-expand-lg là class của Bootstrap để tạo thanh điều hướng responsive -->
            <nav class="navbar navbar-expand-lg">
                <!-- container giới hạn chiều rộng và căn giữa nội dung -->
                <div class="container">
                    <!-- 1. Logo (navbar-brand là class của Bootstrap dành cho logo/tên thương hiệu) -->
                    @Html.ActionLink("FuTho Food", "Index", "Home", new { area = "" }, new { @class = "navbar-brand" })

                    <!-- 2. Menu chính (ở giữa) -->
                    <!-- justify-content-center là class của Bootstrap để đẩy nội dung vào giữa -->
                    <div class="collapse navbar-collapse justify-content-center">
                        <!-- navbar-nav là class Bootstrap cho danh sách menu -->
                        <ul class="navbar-nav">
                            <!-- nav-item và nav-link là các class tiêu chuẩn cho từng mục menu -->
                            <li class="nav-item">
                                @Html.ActionLink(
                                                                  "Trang chủ",
                                                                  "Index",
                                                                  "Home",
                                                                  null,
                                                                  new { @class = "nav-link" + ((currentController == "Home" && currentAction == "Index") ? " active" : "") }
                                                              )
                            </li>
                            <li class="nav-item">
                                @Html.ActionLink(
                                                                  "Thực đơn",
                                                                  "Index",
                                                                  "Menu",
                                                                  null,
                                                                  new { @class = "nav-link" + ((currentController == "Menu" && currentAction == "Index") ? " active" : "") }
                                                              )
                            </li>
                            <li class="nav-item">
                                @Html.ActionLink(
                                                                  "Giới thiệu",
                                                                  "About",
                                                                  "Home",
                                                                  null,
                                                                  new { @class = "nav-link" + ((currentController == "Home" && currentAction == "About") ? " active" : "") }
                                                              )
                            </li>
                        </ul>
                    </div>

                    <!-- 3. Các chức năng bên phải -->
                    <!-- d-flex và align-items-center là các class flexbox của Bootstrap để sắp xếp các item -->
                    <div class="d-flex align-items-center header-actions">
                        <!-- Ô tìm kiếm -->
                        <div class="search-box me-3">
                            <input type="text" class="form-control" placeholder="Tìm kiếm món ăn">
                            <i class="fa-solid fa-magnifying-glass search-icon"></i>
                        </div>
                        <!-- Icons -->
                        <a href="#" class="header-icon"><i class="fa-regular fa-bell"></i></a>
                        <a href="#" class="header-icon"><i class="fa-solid fa-cart-shopping"></i></a>
                        <a href="#" class="header-icon">
                            <img src="https://i.imgur.com/4Ym2k5N.png" alt="User Avatar" class="user-avatar" />
                        </a>
                    </div>
                </div>
            </nav>
        </header>

        <div class="container body-content">
            @RenderBody()
            <hr />
        </div>
    </main>
    <footer class="site-footer">
        <div class="container">
            <div class="footer-top">
                <div class="footer-logo">
                    <a href="#">
                        <span class="logo-bold fst-italic">FuTho</span>
                        <span class="logo-regular">Food</span>
                    </a>
                </div>

                <nav class="footer-nav">
                    <ul>
                        <li><a href="#">Về chúng tôi</a></li>
                        <li><a href="#">Giải đáp thắc mắc</a></li>
                        <li><a href="#">Điều khoản & Điều kiện</a></li>
                    </ul>
                </nav>

                <div class="footer-contact">
                    <p>SĐT Liên hệ: 0971123456</p>
                </div>
            </div>

            <div class="footer-bottom">
                <div class="footer-social">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                </div>
            </div>
        </div>
    </footer>


    @Scripts.Render("~/bundles/jquery")
    <!-- Link Bootstrap JS (sử dụng CDN) -->
    <script>
        (function ($) {
            function setupSlidingUnderline() {
                var $nav = $('.navbar .navbar-nav');
                if (!$nav.length) return;

                var $underline = $nav.find('.nav-underline');
                if (!$underline.length) {
                    $underline = $('<span class="nav-underline" aria-hidden="true"></span>').appendTo($nav);
                }

                var $activeLink = $nav.find('.nav-link.active').first();
                var animationDuration = 360;

                function getTargetTransform($el) {
                    if (!$el || !$el.length) return 'scaleX(0)';
                    var left = $el.position().left;
                    var width = $el.outerWidth();
                    return 'translate3d(' + left + 'px, 0, 0) scaleX(' + width + ')';
                }

                function moveTo($el, withAnimation) {
                    // Tạm thời tắt hiệu ứng nếu không cần
                    $underline.css('transition', withAnimation ? '' : 'none');
                    // Áp dụng vị trí mới
                    $underline[0].style.transform = getTargetTransform($el);

                    // Bắt buộc trình duyệt phải "vẽ" lại ở trạng thái không có transition
                    $underline[0].getBoundingClientRect();

                    // Bật lại hiệu ứng cho các lần tương tác sau
                    $underline.css('transition', '');
                }

                // 1. Khi trang tải xong, đặt gạch chân vào vị trí mà KHÔNG có hiệu ứng
                if ($activeLink.length) {
                    moveTo($activeLink, false);
                }

                // 2. Xử lý khi nhấp vào một mục menu (CÓ hiệu ứng)
                $nav.on('click', '.nav-link', function (e) {
                    var $clickedLink = $(this);
                    var targetUrl = $clickedLink.attr('href');

                    if ($clickedLink.is($activeLink)) {
                        return;
                    }

                    e.preventDefault();
                    moveTo($clickedLink, true); // Di chuyển với hiệu ứng

                    setTimeout(function () {
                        window.location.href = targetUrl;
                    }, animationDuration);
                });

                // 3. Điều chỉnh lại vị trí khi thay đổi kích thước cửa sổ (KHÔNG có hiệu ứng)
                var resizeTimer;
                $(window).on('resize', function () {
                    clearTimeout(resizeTimer);
                    resizeTimer = setTimeout(function () {
                        var $currentActive = $nav.find('.nav-link.active').first();
                        if ($currentActive.length) {
                            moveTo($currentActive, false);
                        }
                    }, 80);
                });
            }

            $(document).ready(setupSlidingUnderline);

        })(jQuery);
    </script>

    @RenderSection("scripts", required: false)
</body>
</html>



